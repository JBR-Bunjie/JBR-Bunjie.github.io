{"title":"基本的Python爬虫","uid":"d2b3e77ca5e5c321ffd72dd8a363d797","slug":"Language Learning/Python/python爬虫","date":"2022-12-23T04:23:23.000Z","updated":"2023-10-27T20:01:22.000Z","comments":true,"path":"api/articles/Language Learning/Python/python爬虫.json","keywords":null,"cover":"https://raw.githubusercontent.com/JBR-Bunjie/JBR-Bunjie/main/back.jpg","content":"<h1 id=\"基本的python爬虫\">基本的Python爬虫</h1>\r\n<h2\r\nid=\"第一步引入包并准备临时存储数据的列表\">第一步：引入包并准备临时存储数据的列表</h2>\r\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">import urllib.request\nimport urllib.parse\nimport requests\nfrom bs4 import BeautifulSoup\nimport re\nimport random, time # 设置每个网页之间的爬取间隔，防止被ban\n# import xlwt, xlwings, sqlite3\n# import selenium\n\n# 1.设定爬取网页对象\nurl &#x3D; &quot;&quot;\n# 2 准备临时保存数据的列表\nA &#x3D; []\nB &#x3D; []\n...\n# 3 文件保存路径\nsaveAddress &#x3D; &quot;D:\\\\project\\\\code\\\\python\\\\&quot;\n# 4 设立序号num\nnum &#x3D; 0</code></pre>\r\n<h2 id=\"第二步获取网页内容源代码\">第二步：获取网页内容（源代码）</h2>\r\n<h4 id=\"采用urllib\">采用<strong>urllib</strong></h4>\r\n<ol type=\"1\">\r\n<li><p>使用手册：</p>\r\n<p><a href=\"https://www.runoob.com/python3/python-urllib.html\">Python\r\nurllib | 菜鸟教程 (runoob.com)</a></p>\r\n<p><a\r\nhref=\"https://docs.python.org/3/library/urllib.request.html#module-urllib.request\">urllib.request\r\n— Extensible library for opening URLs — Python 3.9.6\r\ndocumentation</a></p></li>\r\n<li><p>简明教程：</p>\r\n<blockquote>\r\n<ol type=\"1\">\r\n<li><p><strong>urllib</strong>包内文件设计：</p>\r\n<ul>\r\n<li><strong>urllib.request</strong> - 打开和读取 URL。它定义了一些打开\r\nURL\r\n的函数和类，包含<strong>授权验证</strong>、<strong>重定向</strong>、<strong>浏览器\r\ncookies</strong>等。</li>\r\n<li><strong>urllib.error</strong> - 包含 urllib.request\r\n抛出的异常。</li>\r\n<li><strong>urllib.parse</strong> - 解析 URL。</li>\r\n<li><strong>urllib.robotparser</strong> - 解析 robots.txt 文件。</li>\r\n</ul></li>\r\n<li><p>打开一个 URL：</p>\r\n<p>urllib.request.urlopen(url, data=None, [timeout, ], cafile=None,\r\ncapath=None, cadefault=False, context=None)</p>\r\n<p>注意返回值：This function always returns an object which can work as\r\na <a\r\nhref=\"https://docs.python.org/3/glossary.html#term-context-manager\">context\r\nmanager</a> <strong>and</strong> has the properties <em>url</em>,\r\n<em>headers</em>, and <em>status</em>.</p>\r\n<p>注意 url 对象：Open the URL <em>url</em>, which can be either a\r\nstring or a <a\r\nhref=\"https://docs.python.org/3/library/urllib.request.html#urllib.request.Request\"><code>Request</code></a>\r\nobject.</p></li>\r\n<li><p>解析 urlopen()的返回值：（注意还要 decode()）</p>\r\n<p>read( [length = number] )</p>\r\n<p>readline( )</p>\r\n<p>readlines( [ ] )：返回列表</p></li>\r\n<li><p>模拟头部信息（身份伪装）：</p>\r\n<p>urllib.request.Request(url, data=None, headers={},\r\norigin_req_host=None, unverifiable=False, method=None)</p>\r\n<p><del>如果用到了 Request 对象，自然是直接将 data 放在这里面而不是在\r\nurlopen 里</del></p></li>\r\n</ol>\r\n</blockquote></li>\r\n</ol>\r\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">def ask_html(i):\n\t# 对基础url做处理，拿到新的、需要爬取的实际目标网页url，并在接下来对这个网址做处理\n\ttempUrl &#x3D; url + str(i * 25)\n\t# 伪装user-agent\n\theaders &#x3D; &#123;\n\t\t&quot;User-Agent&quot;: &quot;Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) ......&quot;\n\t&#125;\n\t\t# # 用户表单信息\n\t\t# data &#x3D; bytes(urllib.parse.urlencode(&#123;&#39;user_name&#39;: &#39;bunjie&#39;&#125;), encoding&#x3D;&#39;utf-8&#39;)，是urlopen中的data参数，用来发送post请求，否则是get请求\n\t# 对爬虫身份做封装\n\tresponse &#x3D; urllib.request.Request(url&#x3D;url_now, headers&#x3D;headers, method&#x3D;&quot;GET&quot;) # 要发送表单信息的话，请使用POST\n\t# 进行网页爬取并解码\n\treq &#x3D; urllib.request.urlopen(response, timeout&#x3D;30)\n\thtml &#x3D; req.read().decode(&#39;utf-8&#39;)\n\t# 返回目标网页对应的html代码内容\n\treturn html</code></pre>\r\n<h4 id=\"采用-requests\">采用 requests</h4>\r\n<blockquote>\r\n<ol type=\"1\">\r\n<li>官方示例：</li>\r\n</ol>\r\n</blockquote>\r\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">&gt;&gt;&gt; r &#x3D; requests.get(&#39;https:&#x2F;&#x2F;api.github.com&#x2F;user&#39;, auth&#x3D;(&#39;user&#39;, &#39;pass&#39;))\n&gt;&gt;&gt; r.status_code\n200\n&gt;&gt;&gt; r.headers[&#39;content-type&#39;]\n&#39;application&#x2F;json; charset&#x3D;utf8&#39;\n&gt;&gt;&gt; r.encoding\n&#39;utf-8&#39;\n&gt;&gt;&gt; r.text\n&#39;&#123;&quot;type&quot;:&quot;User&quot;...&#39;\n&gt;&gt;&gt; r.json()\n&#123;&#39;private_gists&#39;: 419, &#39;total_private_repos&#39;: 77, ...&#125;</code></pre>\r\n<blockquote>\r\n<ol start=\"2\" type=\"1\">\r\n<li><p>文档：</p>\r\n<p><a href=\"https://docs.python-requests.org/en/master/\">Requests: HTTP\r\nfor Humans™ — Requests 2.26.0 documentation\r\n(python-requests.org)</a></p>\r\n<p><a href=\"https://docs.python-requests.org/zh_CN/latest/\">Requests: 让\r\nHTTP 服务人类 — Requests 2.18.1 文档 (python-requests.org)</a></p></li>\r\n<li><p>简明教程：</p>\r\n<ol type=\"1\">\r\n<li><p>API Reference:</p>\r\n<blockquote>\r\n<p><strong><code>requests</code>.<code>get</code></strong>(<em>url</em>,\r\n<em>params=None</em>, <em>**kwargs</em>)</p>\r\n<table>\r\n<colgroup>\r\n<col style=\"width: 3%\" />\r\n<col style=\"width: 96%\" />\r\n</colgroup>\r\n<thead>\r\n<tr class=\"header\">\r\n<th style=\"text-align: left;\">Parameters:</th>\r\n<th style=\"text-align: left;\"><strong>url</strong> – URL for the new <a\r\nhref=\"https://docs.python-requests.org/en/latest/api/#requests.Request\"><code>Request</code></a>\r\nobject.<br><strong>params</strong> – (optional) Dictionary, list of\r\ntuples or bytes to send in the query string for the <a\r\nhref=\"https://docs.python-requests.org/en/latest/api/#requests.Request\"><code>Request</code></a>.<br/><strong>**kwargs</strong>\r\n– Optional arguments that <code>request</code> takes.</th>\r\n</tr>\r\n</thead>\r\n<tbody>\r\n<tr class=\"odd\">\r\n<td style=\"text-align: left;\">Returns:</td>\r\n<td style=\"text-align: left;\"><a\r\nhref=\"https://docs.python-requests.org/en/latest/api/#requests.Response\"><code>Response</code></a>\r\nobject</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</blockquote>\r\n<blockquote>\r\n<p><strong><code>requests</code>.<code>post</code></strong>(<em>url</em>,\r\n<em>data=None</em>, <em>json=None</em>, <em>**kwargs</em>)</p>\r\n<p>Sends a POST request.</p>\r\n<table>\r\n<colgroup>\r\n<col style=\"width: 2%\" />\r\n<col style=\"width: 97%\" />\r\n</colgroup>\r\n<thead>\r\n<tr class=\"header\">\r\n<th style=\"text-align: left;\">Parameters:</th>\r\n<th><strong>url</strong> – URL for the new <a\r\nhref=\"https://docs.python-requests.org/en/latest/api/#requests.Request\"><code>Request</code></a>\r\nobject.<br><strong>data</strong> – (optional) Dictionary, list of\r\ntuples, bytes, or file-like object to send in the body of the <a\r\nhref=\"https://docs.python-requests.org/en/latest/api/#requests.Request\"><code>Request</code></a>.<br/><strong>json</strong>\r\n– (optional) json data to send in the body of the <a\r\nhref=\"https://docs.python-requests.org/en/latest/api/#requests.Request\"><code>Request</code></a>.<br/><strong>**kwargs</strong>\r\n– Optional arguments that <code>request</code> takes.</th>\r\n</tr>\r\n</thead>\r\n<tbody>\r\n<tr class=\"odd\">\r\n<td style=\"text-align: left;\">Returns:</td>\r\n<td><a\r\nhref=\"https://docs.python-requests.org/en/latest/api/#requests.Response\"><code>Response</code></a>\r\nobject</td>\r\n</tr>\r\n</tbody>\r\n</table>\r\n</blockquote>\r\n<blockquote>\r\n<p><strong>**kwargs 参数列表:</strong></p>\r\n<ul>\r\n<li><strong>params</strong> – (optional) Dictionary, list of tuples or\r\nbytes to send in the query string for the <a\r\nhref=\"https://docs.python-requests.org/en/latest/api/#requests.Request\"><code>Request</code></a>.</li>\r\n<li><strong>data</strong> – (optional) Dictionary, list of tuples,\r\nbytes, or file-like object to send in the body of the <a\r\nhref=\"https://docs.python-requests.org/en/latest/api/#requests.Request\"><code>Request</code></a>.</li>\r\n<li><strong>json</strong> – (optional) A JSON serializable Python object\r\nto send in the body of the <a\r\nhref=\"https://docs.python-requests.org/en/latest/api/#requests.Request\"><code>Request</code></a>.</li>\r\n<li><strong>headers</strong> – (optional) Dictionary of HTTP Headers to\r\nsend with the <a\r\nhref=\"https://docs.python-requests.org/en/latest/api/#requests.Request\"><code>Request</code></a>.</li>\r\n<li><strong>cookies</strong> – (optional) Dict or CookieJar object to\r\nsend with the <a\r\nhref=\"https://docs.python-requests.org/en/latest/api/#requests.Request\"><code>Request</code></a>.</li>\r\n<li><strong>files</strong> – (optional) Dictionary of\r\n<code>'name': file-like-objects</code> (or\r\n<code>&#123;'name': file-tuple&#125;</code>) for multipart encoding upload.\r\n<code>file-tuple</code> can be a 2-tuple\r\n<code>('filename', fileobj)</code>, 3-tuple\r\n<code>('filename', fileobj, 'content_type')</code> or a 4-tuple\r\n<code>('filename', fileobj, 'content_type', custom_headers)</code>,\r\nwhere <code>'content-type'</code> is a string defining the content type\r\nof the given file and <code>custom_headers</code> a dict-like object\r\ncontaining additional headers to add for the file.</li>\r\n<li><strong>auth</strong> – (optional) Auth tuple to enable\r\nBasic/Digest/Custom HTTP Auth.</li>\r\n<li><strong>timeout</strong> (<a\r\nhref=\"https://docs.python.org/3/library/functions.html#float\"><em>float</em></a>\r\n<em>or</em> <a\r\nhref=\"https://docs.python.org/3/library/stdtypes.html#tuple\"><em>tuple</em></a>)\r\n– (optional) How many seconds to wait for the server to send data before\r\ngiving up, as a float, or a <a\r\nhref=\"https://docs.python-requests.org/en/latest/user/advanced/#timeouts\">(connect\r\ntimeout, read timeout)</a> tuple.</li>\r\n<li><strong>allow_redirects</strong> (<a\r\nhref=\"https://docs.python.org/3/library/functions.html#bool\"><em>bool</em></a>)\r\n– (optional) Boolean. Enable/disable\r\nGET/OPTIONS/POST/PUT/PATCH/DELETE/HEAD redirection. Defaults to\r\n<code>True</code>.</li>\r\n<li><strong>proxies</strong> – (optional) Dictionary mapping protocol to\r\nthe URL of the proxy.</li>\r\n<li><strong>verify</strong> – (optional) Either a boolean, in which case\r\nit controls whether we verify the server’s TLS certificate, or a string,\r\nin which case it must be a path to a CA bundle to use. Defaults to\r\n<code>True</code>.</li>\r\n<li><strong>stream</strong> – (optional) if <code>False</code>, the\r\nresponse content will be immediately downloaded.</li>\r\n<li><strong>cert</strong> – (optional) if String, path to ssl client\r\ncert file (.pem). If Tuple, (‘cert’, ‘key’) pair.</li>\r\n</ul>\r\n</blockquote></li>\r\n</ol></li>\r\n</ol>\r\n<pre class=\"line-numbers language-powershell\" data-language=\"powershell\"><code class=\"language-powershell\">&gt; *class* **&#96;requests&#96;.&#96;Response&#96;**\n&gt;\n&gt; The [&#96;Response&#96;](https:&#x2F;&#x2F;docs.python-requests.org&#x2F;en&#x2F;latest&#x2F;api&#x2F;#requests.Response) object, which contains a server’s response to an HTTP request.\n&gt;\n&gt; 1. **content**\n&gt;\n&gt; ​\t\tContent of the response, in bytes.\n&gt;\n&gt; 2. **text**\n&gt;\n&gt;    Content of the response, in unicode.\n&gt;\n&gt;    If Response.encoding is None, encoding will be guessed using &#96;charset_normalizer&#96; or &#96;chardet&#96;.\n&gt;\n&gt;    The encoding of the response content is determined based solely on HTTP headers, following RFC 2616 to the letter. If you can take advantage of non-HTTP knowledge to make a better guess at the encoding, you should set &#96;r.encoding&#96; appropriately before accessing this property.\n&gt;\n&gt; 3. **&#96;url&#96; *&#x3D; None***\n&gt;\n&gt;    Final URL location of Response.\n&gt;\n&gt; 4. **&#96;status_code&#96; *&#x3D; None***\n&gt;\n&gt;    Integer Code of responded HTTP Status, e.g. 404 or 200.\n&gt;\n&gt; 5. **&#96;request&#96; *&#x3D; None***\n&gt;\n&gt;    The [&#96;PreparedRequest&#96;](https:&#x2F;&#x2F;docs.python-requests.org&#x2F;en&#x2F;latest&#x2F;api&#x2F;#requests.PreparedRequest) object to which this is a response.\n&gt;\n&gt;    You can **check the response** header through this method!\n&gt;\n&gt; &gt; When you make a request, Requests makes educated guesses about the encoding of the response based on the HTTP headers. The text encoding guessed by Requests is used when you access **&#96;r.text&#96;**. You can find out what encoding Requests is using, and change it, using the **&#96;r.encoding&#96;** property:\n&gt; &gt;\n&gt; &gt; &#96;&#96;&#96;python\n&gt; &gt; &gt;&gt;&gt; r.encoding\n&gt; &gt; &#39;utf-8&#39;\n&gt; &gt; &gt;&gt;&gt; r.encoding &#x3D; &#39;ISO-8859-1&#39;\n&gt; &gt; &#96;&#96;&#96;</code></pre>\r\n<ol start=\"2\" type=\"1\">\r\n<li><h2 id=\"make-a-request\">Make a Request</h2></li>\r\n</ol>\r\n<blockquote>\r\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">&gt;&gt;&gt; import requests # first import the module\n\n&gt;&gt;&gt; r &#x3D; requests.get(&#39;https:&#x2F;&#x2F;api.github.com&#x2F;events&#39;) # get a webpage. In GET requests mode</code></pre>\r\n<p>Now, we have a Response object called r. We can get all the\r\ninformation we need from this object.</p>\r\n<p>meanwhile, requests’ simple API means that all forms of HTTP request\r\nare as obvious. For example, this is how you make an HTTP POST\r\nrequest:</p>\r\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">&gt;&gt;&gt; r &#x3D; requests.post(&#39;https:&#x2F;&#x2F;httpbin.org&#x2F;post&#39;, data &#x3D; &#123;&#39;key&#39;:&#39;value&#39;&#125;)\n# 我们当热可以在之前就将要发送的数据包data封装好，在post中就可以直接调用了</code></pre>\r\n<p>Nice, rights? What about the other HTTP request types: PUT, DELETE,\r\nHEAD and OPTIONS? These are all just as simple:</p>\r\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">&gt;&gt;&gt; r &#x3D; requests.put(&#39;https:&#x2F;&#x2F;httpbin.org&#x2F;put&#39;, data &#x3D; &#123;&#39;key&#39;:&#39;value&#39;&#125;)\n&gt;&gt;&gt; r &#x3D; requests.delete(&#39;https:&#x2F;&#x2F;httpbin.org&#x2F;delete&#39;)\n&gt;&gt;&gt; r &#x3D; requests.head(&#39;https:&#x2F;&#x2F;httpbin.org&#x2F;get&#39;)\n&gt;&gt;&gt; r &#x3D; requests.options(&#39;https:&#x2F;&#x2F;httpbin.org&#x2F;get&#39;)</code></pre>\r\n</blockquote>\r\n<ol start=\"2\" type=\"1\">\r\n<li><h2 id=\"passing-parameters-in-urls\">Passing Parameters In\r\nURLs</h2></li>\r\n</ol>\r\n<blockquote>\r\n<p>You often want to send some sort of data in the URL’s query string.\r\nIf you were constructing the URL by hand, this data would be given as\r\nkey/value pairs in the URL after a question mark, e.g.\r\n<code>httpbin.org/get?key=val</code>. Requests allows you to provide\r\nthese arguments as a dictionary of strings, using the\r\n<code>params</code> keyword argument. As an example, if you wanted to\r\npass <code>key1=value1</code> and <code>key2=value2</code> to\r\n<code>httpbin.org/get</code>, you would use the following code:</p>\r\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">&gt;&gt;&gt; payload &#x3D; &#123;&#39;key1&#39;: &#39;value1&#39;, &#39;key2&#39;: &#39;value2&#39;&#125;\n&gt;&gt;&gt; r &#x3D; requests.get(&#39;https:&#x2F;&#x2F;httpbin.org&#x2F;get&#39;, params&#x3D;payload)</code></pre>\r\n<p>You can see that the URL has been correctly encoded by printing the\r\nURL:</p>\r\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">&gt;&gt;&gt; print(r.url)\nhttps:&#x2F;&#x2F;httpbin.org&#x2F;get?key2&#x3D;value2&amp;key1&#x3D;value1</code></pre>\r\n<p>Note that any dictionary key whose value is <code>None</code> will\r\nnot be added to the URL’s query string.</p>\r\n</blockquote>\r\n</blockquote>\r\n<h2 id=\"第三步利用-bs-和-re-来对爬取内容做处理\">第三步：利用 bs 和 re\r\n来对爬取内容做处理</h2>\r\n<h4 id=\"bs4一级处理可跳过\">bs4：一级处理（可跳过）</h4>\r\n<ol type=\"1\">\r\n<li><p>使用手册：</p>\r\n<p><a\r\nhref=\"https://beautifulsoup.readthedocs.io/zh_CN/v4.4.0/\">Beautiful Soup\r\n4.4.0 文档 — Beautiful Soup 4.2.0 中文 文档</a></p></li>\r\n<li><p>简明教程：</p>\r\n<blockquote>\r\n<ol type=\"1\">\r\n<li><p>创建 BeautifulSoup 对象：</p>\r\n<p>将一段文档传入 BeautifulSoup 的构造方法,就能得到一个文档的对象,\r\n可以传入一段<strong>字符串</strong>或一个<strong>文件</strong>句柄.</p>\r\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">soup &#x3D; BeautifulSoup(open(&quot;index.html&quot;)) # 方法一：读取文件\n\nsoup &#x3D; BeautifulSoup(&quot;&lt;html&gt;data&lt;&#x2F;html&gt;&quot;) # 方法二：读取现成、字符串形式的html代码片段</code></pre>\r\n<p>首先,文档被转换成 Unicode,并且 HTML 的实例都被转换成 Unicode 编码</p>\r\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\">BeautifulSoup(&quot;Sacr&amp;eacute; bleu!&quot;)\n&lt;html&gt;&lt;head&gt;&lt;&#x2F;head&gt;&lt;body&gt;Sacré bleu!&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;</code></pre>\r\n<p>然后,Beautiful Soup\r\n选择最合适的解析器来解析这段文档,如果手动指定解析器那么 Beautiful Soup\r\n会选择指定的解析器来解析文档.(参考 <a\r\nhref=\"https://beautifulsoup.readthedocs.io/zh_CN/v4.4.0/#xml\">解析成\r\nXML</a> ).</p></li>\r\n<li><p>对文档进行处理：</p>\r\n<p>Beautiful Soup 将复杂 HTML 文档转换成一个复杂的树形结构,每个节点都是\r\nPython 对象,所有对象可以归纳为 4 种: <code>Tag</code> ,\r\n<code>NavigableString</code> , <code>BeautifulSoup</code> ,\r\n<code>Comment</code> .</p>\r\n<p><strong><code>Tag</code></strong>：即原文档中的标签，可以通过<strong>name</strong>和<strong>attrs</strong>来直接调用对应的名称和属性，请<em>务必注意属性的返回值！</em>我们还可以通过<strong>string</strong>来调用内容，但是内容不能被直接修改</p>\r\n<p><del>如果只想得到 tag 中包含的文本内容,那么可以嗲用\r\n<code>get_text()</code> 方法,这个方法获取到 tag\r\n中包含的所有文版内容包括子孙 tag 中的内容,并将结果作为 Unicode\r\n字符串返回</del></p>\r\n<p><strong><code>NavigableString</code></strong>：字符串常被包含在 tag\r\n内.Beautiful Soup 用 <code>NavigableString</code> 类来包装 tag\r\n中的字符串，tag 中包含的字符串不能编辑,但是可以被替换成其它的字符串,用\r\n<a\r\nhref=\"https://beautifulsoup.readthedocs.io/zh_CN/v4.4.0/#replace-with\">replace_with()</a>\r\n方法:</p>\r\n<ol type=\"1\">\r\n<li><p>进行文档遍历：低效</p></li>\r\n<li><p>文档搜索（√）：</p>\r\n<ol type=\"1\">\r\n<li><p>select()css 选择器，支持 id(#)，class(.)，tag，父子选择等 css\r\n匹配规则</p>\r\n<p>example: bs.select(a[class = 'hello!' ])</p></li>\r\n<li><p>find_all()几乎同 select，但是支持了正则表达式</p>\r\n<p>example: bs.find<em>all('div', class</em>='item') /\r\nbs.find_all(re.compile(\"a\"))</p></li>\r\n</ol></li>\r\n</ol></li>\r\n</ol>\r\n</blockquote></li>\r\n</ol>\r\n<h4 id=\"re二级处理从根本解决问题\">re：二级处理（从根本解决问题）</h4>\r\n<ol type=\"1\">\r\n<li><p>正则表达式使用手册：</p>\r\n<p><a\r\nhref=\"onenote:https://d.docs.live.net/a85fd0932d62f536/文档/JBR_Bunjie/开发笔记/前端开发笔记/H5.one#正则表达式&amp;section-id=%7B95089512-DFC7-49F9-A7C1-466EEB6B429A%7D&amp;page-id=%7B262783D3-2B94-4AF5-877C-BDB6CBCD4806%7D&amp;end\">正则表达式</a>\r\n(<a\r\nhref=\"https://onedrive.live.com/view.aspx?resid=A85FD0932D62F536!617&amp;id=documents&amp;wd=target(开发笔记%2F前端开发笔记%2FH5.one%7C95089512-DFC7-49F9-A7C1-466EEB6B429A%2F正则表达式%7C262783D3-2B94-4AF5-877C-BDB6CBCD4806%2F)\">Web\r\n视图</a>)</p></li>\r\n<li><p>re 模块使用手册：</p>\r\n<p><a\r\nhref=\"onenote:https://d.docs.live.net/a85fd0932d62f536/文档/JBR_Bunjie/开发笔记/Linux_Windows/python.one#re模块&amp;section-id=%7B973AA90C-36D3-413E-AB01-5823E7C25713%7D&amp;page-id=%7B6914C45C-28DA-48B3-A552-0A19C3C9064D%7D&amp;end\">re\r\n模块</a> (<a\r\nhref=\"https://onedrive.live.com/view.aspx?resid=A85FD0932D62F536!617&amp;id=documents&amp;wd=target(开发笔记%2FLinux_Windows%2Fpython.one%7C973AA90C-36D3-413E-AB01-5823E7C25713%2Fre模块%7C6914C45C-28DA-48B3-A552-0A19C3C9064D%2F)\">Web\r\n视图</a>)</p></li>\r\n</ol>\r\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"># 全部html代码已经在前面的url处理中完全取得\ndef get_information(html):\n\tglobal num\n\tbs &#x3D; BeautifulSoup(html, &#39;lxml&#39;) # 推荐使用lxml作为解析器,因为效率更高.\n\n\tfind_movie_address &#x3D; re.compile(r&#39;&lt;a href&#x3D;&quot;(.*?)&quot;&gt;&#39;, re.S)\n\tfind_title &#x3D; re.compile(r&#39;&lt;span class&#x3D;&quot;title&quot;&gt;(.*?)&lt;&#x2F;span&gt;&#39;, re.S)\n\tfind_more_title &#x3D; re.compile(r&#39;&lt;span class&#x3D;&quot;other&quot;&gt;(.*?)&lt;&#x2F;span&gt;&#39;, re.S)\n\n\tfor item in bs.find_all(&#39;div&#39;, class_&#x3D;&#39;item&#39;):\n\t\tprint(&#39;-&#39;*30)\n\t\tprint(num + 1)\n\t\titem &#x3D; str(item)\n\t\tmovie_address_data.append(re.findall(find_movie_address, item)[0])\n\n\t\tif len(re.findall(find_title, item)) &#x3D;&#x3D; 2:   # 不是所有影片都有“两个title”的class\n\t\t\tmovie_title_data.append(re.findall(find_title, item)[0])\n\t\t\tmovie_traditional_title_data.append(re.findall(find_title, item)[1])\n\t\telse:\n\t\t\tmovie_title_data.append(re.findall(find_title, item)[0])\n\t\t\tmovie_traditional_title_data.append(&#39; &#39;)  # 用空格&#39; &#39;来代表该电影是中文电影，没有外文“原名”\n\n\t\tmovie_more_title_data.append(re.findall(find_more_title, item)[0])\n\n\t\ttemp &#x3D; movie_title_data[num] + movie_traditional_title_data[num] + movie_more_title_data[num]\n\t\tmovie_title_collection.append(temp)\n\n\t\tprint(movie_address_data[num])\n\t\tprint(movie_title_collection[num])\n\t\tnum &#x3D; num + 1\n\t# 模拟正常浏览网页的停留时间\n\ttime.sleep(random.random() * 100)</code></pre>\r\n<h2 id=\"第四步保存数据\">第四步：保存数据</h2>\r\n<ol type=\"1\">\r\n<li><p>excel 表：<a href=\"http://www.python-excel.org/\">Python Resources\r\nfor working with Excel - Working with Excel Files in Python\r\n(python-excel.org)</a></p>\r\n<p>xlwings：<a href=\"https://www.xlwings.org/\">Automate Excel with\r\nPython (Open Source and Free) (xlwings.org)</a></p>\r\n<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"># xlwings示例代码：\n\nimport xlwings as xw\n\n#连接到excel\nworkbook &#x3D; xw.Book(r&#39;path&#x2F;myexcel.xlsx&#39;)#连接excel文件\n#连接到指定单元格\ndata_range &#x3D; workbook.sheets(&#39;Sheet1&#39;).range(&#39;A1&#39;)\n#写入数据\ndata_range.value &#x3D; [1,2,3]\n#保存\nworkbook.save()</code></pre></li>\r\n</ol>\r\n<p>以上步骤综合即是一个完整的 python 爬虫程序</p>\r\n","text":"基本的Python爬虫 第一步：引入包并准备临时存储数据的列表 import urllib.request import urllib.parse import requests from bs4 import BeautifulSoup import re import ran...","link":"","photos":[],"count_time":{"symbolsCount":"13k","symbolsTime":"11 mins."},"categories":[{"name":"Python","slug":"Python","count":9,"path":"api/categories/Python.json"},{"name":"Language Learning","slug":"Python/Language-Learning","count":8,"path":"api/categories/Python/Language-Learning.json"}],"tags":[{"name":"Language Learning","slug":"Language-Learning","count":16,"path":"api/tags/Language-Learning.json"},{"name":"Python","slug":"Python","count":10,"path":"api/tags/Python.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%9F%BA%E6%9C%AC%E7%9A%84python%E7%88%AC%E8%99%AB\"><span class=\"toc-text\">基本的Python爬虫</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%B8%80%E6%AD%A5%E5%BC%95%E5%85%A5%E5%8C%85%E5%B9%B6%E5%87%86%E5%A4%87%E4%B8%B4%E6%97%B6%E5%AD%98%E5%82%A8%E6%95%B0%E6%8D%AE%E7%9A%84%E5%88%97%E8%A1%A8\"><span class=\"toc-text\">第一步：引入包并准备临时存储数据的列表</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%BA%8C%E6%AD%A5%E8%8E%B7%E5%8F%96%E7%BD%91%E9%A1%B5%E5%86%85%E5%AE%B9%E6%BA%90%E4%BB%A3%E7%A0%81\"><span class=\"toc-text\">第二步：获取网页内容（源代码）</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E9%87%87%E7%94%A8urllib\"><span class=\"toc-text\">采用urllib</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#%E9%87%87%E7%94%A8-requests\"><span class=\"toc-text\">采用 requests</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#make-a-request\"><span class=\"toc-text\">Make a Request</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#passing-parameters-in-urls\"><span class=\"toc-text\">Passing Parameters In\r\nURLs</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E4%B8%89%E6%AD%A5%E5%88%A9%E7%94%A8-bs-%E5%92%8C-re-%E6%9D%A5%E5%AF%B9%E7%88%AC%E5%8F%96%E5%86%85%E5%AE%B9%E5%81%9A%E5%A4%84%E7%90%86\"><span class=\"toc-text\">第三步：利用 bs 和 re\r\n来对爬取内容做处理</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#bs4%E4%B8%80%E7%BA%A7%E5%A4%84%E7%90%86%E5%8F%AF%E8%B7%B3%E8%BF%87\"><span class=\"toc-text\">bs4：一级处理（可跳过）</span></a></li><li class=\"toc-item toc-level-4\"><a class=\"toc-link\" href=\"#re%E4%BA%8C%E7%BA%A7%E5%A4%84%E7%90%86%E4%BB%8E%E6%A0%B9%E6%9C%AC%E8%A7%A3%E5%86%B3%E9%97%AE%E9%A2%98\"><span class=\"toc-text\">re：二级处理（从根本解决问题）</span></a></li></ol></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%AC%AC%E5%9B%9B%E6%AD%A5%E4%BF%9D%E5%AD%98%E6%95%B0%E6%8D%AE\"><span class=\"toc-text\">第四步：保存数据</span></a></li></ol></li></ol>","author":{"name":"JBR_Bunjie","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/90251718?v=4","link":"/","description":"仿生程序员会在光环上遇见AI乐正绫吗？","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili-fill.svg","link":"https://space.bilibili.com/415377461"},"github":{"icon":"/svg/social_github.svg","link":"https://github.com/JBR-Bunjie"}}}},"mapped":true,"prev_post":{"title":"使用python自动化处理的文件及zipfile模块的介绍","uid":"54ad4410b8e441eafc3ef2cc6f0cea8f","slug":"Language Learning/Python/使用python解决文件自动化处理的方案及zipfile模块的介绍","date":"2022-12-23T04:23:23.000Z","updated":"2023-10-27T20:02:46.000Z","comments":true,"path":"api/articles/Language Learning/Python/使用python解决文件自动化处理的方案及zipfile模块的介绍.json","keywords":null,"cover":"https://raw.githubusercontent.com/JBR-Bunjie/JBR-Bunjie/main/back.jpg","text":"使用python自动化处理的文件及zipfile模块的介绍 使用 Python 解决文件自动化改名和命名 原因：获取压缩文件的实际名称： 压缩文件名称使用了随机字符，而原文件夹作为压缩文件的根目录来保存，为了避免打开压缩文件才能知道打开的到底是哪个文件，需要将压缩文件内的文件夹名...","link":"","photos":[],"count_time":{"symbolsCount":"3.9k","symbolsTime":"4 mins."},"categories":[{"name":"Python","slug":"Python","count":9,"path":"api/categories/Python.json"},{"name":"Language Learning","slug":"Python/Language-Learning","count":8,"path":"api/categories/Python/Language-Learning.json"}],"tags":[{"name":"Language Learning","slug":"Language-Learning","count":16,"path":"api/tags/Language-Learning.json"},{"name":"Python","slug":"Python","count":10,"path":"api/tags/Python.json"}],"author":{"name":"JBR_Bunjie","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/90251718?v=4","link":"/","description":"仿生程序员会在光环上遇见AI乐正绫吗？","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili-fill.svg","link":"https://space.bilibili.com/415377461"},"github":{"icon":"/svg/social_github.svg","link":"https://github.com/JBR-Bunjie"}}}}},"next_post":{"title":"Merge Sort - 归并排序","uid":"f8c8a85b34fcac6d0fefec2d2d2d9cd5","slug":"Algorithm/SORT/MergeSort/Merge Sort","date":"2022-12-23T04:23:23.000Z","updated":"2023-10-27T14:29:33.000Z","comments":true,"path":"api/articles/Algorithm/SORT/MergeSort/Merge Sort.json","keywords":null,"cover":"https://raw.githubusercontent.com/JBR-Bunjie/JBR-Bunjie/main/back.jpg","text":"Merge Sort 归并排序 Reference： 1.5 归并排序 | 菜鸟教程 (runoob.com) 算法步骤： 概述： 申请空间，使其大小为两个已经排序序列之和，该空间用来存放合并后的序列； 设定两个指针，最初位置分别为两个已经排序序列的起始位置； 比较两个指针所指向...","link":"","photos":[],"count_time":{"symbolsCount":"2.9k","symbolsTime":"3 mins."},"categories":[{"name":"Algorithm","slug":"Algorithm","count":31,"path":"api/categories/Algorithm.json"}],"tags":[{"name":"Algorithm","slug":"Algorithm","count":31,"path":"api/tags/Algorithm.json"},{"name":"Sort","slug":"Sort","count":2,"path":"api/tags/Sort.json"}],"author":{"name":"JBR_Bunjie","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/90251718?v=4","link":"/","description":"仿生程序员会在光环上遇见AI乐正绫吗？","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili-fill.svg","link":"https://space.bilibili.com/415377461"},"github":{"icon":"/svg/social_github.svg","link":"https://github.com/JBR-Bunjie"}}}}}}