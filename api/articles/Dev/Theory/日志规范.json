{"title":"日志格式","uid":"743056c4369a9fa1f8f105370c847ec2","slug":"Dev/Theory/日志规范","date":"2022-12-23T04:23:23.000Z","updated":"2023-10-27T19:43:25.000Z","comments":true,"path":"api/articles/Dev/Theory/日志规范.json","keywords":null,"cover":"https://raw.githubusercontent.com/JBR-Bunjie/JBR-Bunjie/main/back.jpg","content":"<h1 id=\"日志格式\">日志格式</h1>\r\n<p>通用前缀 class.method LEVEL | KEY | SUB_KEY | param1=x;param2=x;... |\r\nrs=JSON | traceId=xxx[ | 其它自定义日志]</p>\r\n<p>KEY：标示业务领域，如“领券”</p>\r\n<p>SUBKEY：标示业务领域中具体的逻辑，如“策略决策”、“权益决策”、“调用\r\nUMP”等</p>\r\n<p><strong>LEVEL：DEBUG / TRACE / MONITOR / WARN</strong></p>\r\n<h2 id=\"要求\">要求：</h2>\r\n<p>查找日志时，再一次查询中可以顺利通过一个或多个关键字的组合，找到一条完整的业务处理链路。</p>\r\n<p>如通过一个 userId 和 KEY，可以完整的找到这个用户的领券全过程。</p>\r\n<h2 id=\"调试日志\">调试日志</h2>\r\n<p>仅在调试阶段需要输出，线上一般不输出。</p>\r\n<p>日志可以包括每次请求的详细出入参等信息。</p>\r\n<p>线上必须有开关可以控制这类日志的打印。</p>\r\n<p>level=DEBUG</p>\r\n<h2 id=\"普通日志\">普通日志</h2>\r\n<p>用户追踪必要的代码执行记录，线上一般打印出来，大促时可以降级。</p>\r\n<p>日志可以包括每次外部请求的详细出入参，以及内部请求的关键参数。</p>\r\n<p>请求出入参较长时，可考虑只打印关键参数。</p>\r\n<p>level=TRACE</p>\r\n<h2 id=\"业务指标项日志\">业务指标项日志</h2>\r\n<p>记录必要的业务活动，通过 sls 或 sunfire 产出业务大盘</p>\r\n<p>level=MONITOR</p>\r\n<h2 id=\"监控报警项日志\">监控报警项日志</h2>\r\n<p>通过 sunfire 产出报警</p>\r\n<p>level=WARN</p>\r\n<h2 id=\"自定义日志\">自定义日志</h2>\r\n<p>不做格式要求，自行打印，注意避免过量日志造成线上磁盘资源紧张</p>\r\n","text":"日志格式 通用前缀 class.method LEVEL | KEY | SUB_KEY | param1=x;param2=x;... | rs=JSON | traceId=xxx[ | 其它自定义日志] KEY：标示业务领域，如“领券” SUBKEY：标示业务领域中具体的逻...","link":"","photos":[],"count_time":{"symbolsCount":627,"symbolsTime":"1 mins."},"categories":[{"name":"Theroy","slug":"Theroy","count":5,"path":"api/categories/Theroy.json"}],"tags":[{"name":"Theroy","slug":"Theroy","count":5,"path":"api/tags/Theroy.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E6%97%A5%E5%BF%97%E6%A0%BC%E5%BC%8F\"><span class=\"toc-text\">日志格式</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%A6%81%E6%B1%82\"><span class=\"toc-text\">要求：</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%B0%83%E8%AF%95%E6%97%A5%E5%BF%97\"><span class=\"toc-text\">调试日志</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%99%AE%E9%80%9A%E6%97%A5%E5%BF%97\"><span class=\"toc-text\">普通日志</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%B8%9A%E5%8A%A1%E6%8C%87%E6%A0%87%E9%A1%B9%E6%97%A5%E5%BF%97\"><span class=\"toc-text\">业务指标项日志</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%9B%91%E6%8E%A7%E6%8A%A5%E8%AD%A6%E9%A1%B9%E6%97%A5%E5%BF%97\"><span class=\"toc-text\">监控报警项日志</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%97%A5%E5%BF%97\"><span class=\"toc-text\">自定义日志</span></a></li></ol></li></ol>","author":{"name":"JBR_Bunjie","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/90251718?v=4","link":"/","description":"仿生程序员会在光环上遇见AI乐正绫吗？","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili-fill.svg","link":"https://space.bilibili.com/415377461"},"github":{"icon":"/svg/social_github.svg","link":"https://github.com/JBR-Bunjie"}}}},"mapped":true,"prev_post":{"title":"卡拉彼丘游戏设计的一点思考","uid":"7c79e745614c96c9bf175ffbbcfcb82c","slug":"游戏设计分析/卡拉彼丘的游戏设计分析","date":"2022-12-23T04:23:23.000Z","updated":"2023-10-31T00:36:52.163Z","comments":true,"path":"api/articles/游戏设计分析/卡拉彼丘的游戏设计分析.json","keywords":null,"cover":"https://raw.githubusercontent.com/JBR-Bunjie/JBR-Bunjie/main/back.jpg","text":"卡拉彼丘游戏设计迷思 独特的战术动作：弦化 机动性、 拉人、回复与局内突破的天然矛盾 长时间的 ttk ","link":"","photos":[],"count_time":{"symbolsCount":57,"symbolsTime":"1 mins."},"categories":[{"name":"Algorithm","slug":"Algorithm","count":31,"path":"api/categories/Algorithm.json"}],"tags":[{"name":"Algorithm","slug":"Algorithm","count":31,"path":"api/tags/Algorithm.json"}],"author":{"name":"JBR_Bunjie","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/90251718?v=4","link":"/","description":"仿生程序员会在光环上遇见AI乐正绫吗？","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili-fill.svg","link":"https://space.bilibili.com/415377461"},"github":{"icon":"/svg/social_github.svg","link":"https://github.com/JBR-Bunjie"}}}}},"next_post":{"title":"Birthday Paradox","uid":"b0298187d3b43e42af9c0e2b93f65724","slug":"Algorithm/BirthdayParadox/生日悖论&鸽笼理论-birthday paradox&pigeonhole principle","date":"2022-12-23T04:23:23.000Z","updated":"2023-11-07T12:39:27.072Z","comments":true,"path":"api/articles/Algorithm/BirthdayParadox/生日悖论&鸽笼理论-birthday paradox&pigeonhole principle.json","keywords":null,"cover":"https://raw.githubusercontent.com/JBR-Bunjie/JBR-Bunjie/main/back.jpg","text":"生日悖论-birthday paradox 一个很简单的概率关系，由于其反直觉而称为“悖论”： 一个房间要多少人，则两个人的生日相同的概率 对应情况 所需人数 大于50%？ 23人 大于70%？ 30人 大于97%？ 50人 大于99%？ 57人 可以发现，概率大于99%所需的人...","link":"","photos":[],"count_time":{"symbolsCount":966,"symbolsTime":"1 mins."},"categories":[{"name":"Algorithm","slug":"Algorithm","count":31,"path":"api/categories/Algorithm.json"}],"tags":[{"name":"Algorithm","slug":"Algorithm","count":31,"path":"api/tags/Algorithm.json"}],"author":{"name":"JBR_Bunjie","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/90251718?v=4","link":"/","description":"仿生程序员会在光环上遇见AI乐正绫吗？","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili-fill.svg","link":"https://space.bilibili.com/415377461"},"github":{"icon":"/svg/social_github.svg","link":"https://github.com/JBR-Bunjie"}}}}}}